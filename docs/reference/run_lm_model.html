<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='This function takes an animalcules-formatted MultiAssayExperiment and
runs an independent linear model for each taxon. The model predicts taxon log
CPM abundance as a product of user-specified covariates. This model can
be used for general microbiome analyses without repeated measures data.
Note, the "broom", and
"broom.mixed" packages are required to use the testing functionality of this
package; both can be installed via CRAN.'><title>Compute linear models (LM) on microbiome data — run_lm_model • LegATo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute linear models (LM) on microbiome data — run_lm_model"><meta property="og:description" content='This function takes an animalcules-formatted MultiAssayExperiment and
runs an independent linear model for each taxon. The model predicts taxon log
CPM abundance as a product of user-specified covariates. This model can
be used for general microbiome analyses without repeated measures data.
Note, the "broom", and
"broom.mixed" packages are required to use the testing functionality of this
package; both can be installed via CRAN.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">LegATo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/LegATo_vignette.html">Command Line Analysis</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Function Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Package News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/aubreyodom/legato">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute linear models (LM) on microbiome data</h1>
      <small class="dont-index">Source: <a href="https://github.com/wejlab/LegATo/blob/HEAD/R/run_lm_model.R" class="external-link"><code>R/run_lm_model.R</code></a></small>
      <div class="d-none name"><code>run_lm_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes an animalcules-formatted <code>MultiAssayExperiment</code> and
runs an independent linear model for each taxon. The model predicts taxon log
CPM abundance as a product of user-specified covariates. This model can
be used for general microbiome analyses without repeated measures data.
Note, the "broom", and
"broom.mixed" packages are required to use the testing functionality of this
package; both can be installed via CRAN.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_lm_model</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  taxon_level <span class="op">=</span> <span class="st">"genus"</span>,</span>
<span>  <span class="va">fixed_cov</span>,</span>
<span>  p_adj_method <span class="op">=</span> <span class="st">"fdr"</span>,</span>
<span>  plot_out <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plotsave_loc <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  plot_terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dat</dt>
<dd><p>A MultiAssayExperiment object specially formatted as an animalcules output.</p></dd>


<dt>taxon_level</dt>
<dd><p>Character string, default is <code>"genus"</code>.</p></dd>


<dt>fixed_cov</dt>
<dd><p>A character vector naming covariates to be tested.</p></dd>


<dt>p_adj_method</dt>
<dd><p>A character string specifying the correction method. Can
be abbreviated. See details. Default is <code>"fdr"</code>.</p></dd>


<dt>plot_out</dt>
<dd><p>Logical indicating whether plots should be output alongside
the model results. Default is <code>FALSE</code>.</p></dd>


<dt>plotsave_loc</dt>
<dd><p>A character string giving the folder path to save plot
outputs. This defaults to the current working directory.</p></dd>


<dt>plot_terms</dt>
<dd><p>Character vector. Which terms should be examined in the
plot output? Can overlap with the <code>fixed_cov</code> inputs.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to <code>ggsave</code> for plot creation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>data.frame</code> of modeling results.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>P-values are adjusted for the model coefficients within each taxon. The
following methods are permitted: <code>c("holm", "hochberg", "hommel",
"bonferroni", "BH", "BY", "fdr", "none")</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/MAE.RDS"</span>, package <span class="op">=</span> <span class="st">"LegATo"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="filter_MAE.html">filter_MAE</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The overall range of relative abundance counts between samples is (13218, 3016276) </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of OTUs that exhibit a relative abundance &gt;3% in at least 5% of the total samples: 17/1690</span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">run_lm_model</span><span class="op">(</span><span class="va">dat</span>, fixed_cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timepoint"</span>, <span class="st">"HIVStatus"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    plot_out <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Coefficient Coefficient Estimate Standard Error Statistic Unadj p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 (Intercept)         1.583191e+05   38802.912402  4.080084  7.012551e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 (Intercept)         4.151148e+01      19.455765  2.133634  3.435965e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 (Intercept)         1.085153e+01       4.747316  2.285824  2.354463e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 (Intercept)         9.800220e+00       4.584216  2.137818  3.401292e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 (Intercept)         4.237653e+00       2.059365  2.057748  4.119716e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 (Intercept)         5.523260e+00       4.591306  1.202982  2.307169e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Taxon Adj p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1               Other 0.001192134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            Belnapia 0.116725295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         Actinotalea 0.116725295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          Leptothrix 0.116725295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Limosilactobacillus 0.116725295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Staphylococcus 0.392218737</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Site created by Aubrey Odom.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

